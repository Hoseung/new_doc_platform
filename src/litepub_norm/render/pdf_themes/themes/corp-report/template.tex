% corp-report: Modern Corporate Template
% Clean, polished style for executive summaries and whitepapers
% Features: Cover page, colored boxes, fancy headers
% Requires XeLaTeX with xeCJK for Korean support

\documentclass[11pt,a4paper]{article}

% Load theme style package
\usepackage{assets/theme}

% Essential packages
\usepackage{fontspec}
\usepackage{xeCJK}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{float}
\usepackage{array}
\usepackage{calc}
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}

% Page geometry
\geometry{
  a4paper,
  margin=2.5cm,
  top=3.5cm,
  bottom=3cm,
  headheight=20pt
}

% Font configuration (Sans-serif primary for modern look)
\setmainfont{DejaVu Sans}[
  BoldFont=DejaVu Sans Bold,
  ItalicFont=DejaVu Sans Oblique,
  BoldItalicFont=DejaVu Sans Bold Oblique
]
\setsansfont{DejaVu Sans}[
  BoldFont=DejaVu Sans Bold,
  ItalicFont=DejaVu Sans Oblique
]
\setmonofont{DejaVu Sans Mono}[Scale=0.85]

% CJK configuration (Korean)
\xeCJKsetup{
  CJKspace=true,
  CJKecglue={\hskip 0.15em plus 0.05em minus 0.05em}
}
\setCJKmainfont{Noto Sans CJK KR}[BoldFont=Noto Sans CJK KR Bold]
\setCJKsansfont{Noto Sans CJK KR}
\setCJKmonofont{Noto Sans Mono CJK KR}

% Hyperref configuration
\hypersetup{
  colorlinks=true,
  linkcolor=corpAccent,
  urlcolor=corpAccent,
  citecolor=corpAccent,
  pdfauthor={$author-meta$},
  pdftitle={$title-meta$},
  bookmarksnumbered=true,
  bookmarksopen=true
}

% Headers and footers (fancy style)
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\color{corpGray}\leftmark}
\fancyhead[R]{\small\color{corpGray}\thepage}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[C]{\small\color{corpGray}$if(footer)$$footer$$endif$}

% Section numbering depth
\setcounter{secnumdepth}{3}

% Paragraph spacing
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.8em}

% List customization
\setlist{noitemsep, topsep=0.5em}

% Table styling
\renewcommand{\arraystretch}{1.4}

% Pandoc compatibility
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
% passthrough for inline code with roles (idiomatic highlighting)
\newcommand{\passthrough}[1]{#1}

% Pandoc 3.x bounded image support - constrain to text width
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{%
  \sbox\pandoc@box{#1}%
  \ifdim\wd\pandoc@box>\linewidth
    \resizebox{\linewidth}{!}{#1}%
  \else
    #1%
  \fi
}
\makeatother
\makeatletter
\providecommand{\real}[1]{\strip@pt\dimexpr #1pt\relax}
\makeatother

% Chapter compatibility (for article class)
\makeatletter
\@ifundefined{chapter}{%
  \newcommand{\@litepub@chapter}[1]{\section{#1}}
  \newcommand{\@litepub@schapter}[1]{\section*{#1}}
  \newcommand{\chapter}{\@ifstar\@litepub@schapter\@litepub@chapter}
  \providecommand{\chaptermark}[1]{\markboth{#1}{}}
}{}
\makeatother

% Long table settings
\setlength{\LTpre}{0pt}
\setlength{\LTpost}{0pt}

% Fix for Pandoc's longtable without caption (requires dummy 'none' counter)
\newcounter{none}

$if(highlighting-macros)$
$highlighting-macros$
$endif$

$for(header-includes)$
$header-includes$
$endfor$

\begin{document}

% ============================================================
% COVER PAGE
% ============================================================
$if(title)$
\begin{titlepage}
\newgeometry{margin=2cm}

% Accent bar at top
\noindent\colorbox{corpAccent}{\makebox[\dimexpr\textwidth+4cm\relax][l]{\rule{0pt}{1cm}}}

\vspace{3cm}

% Title
\begin{flushleft}
{\Huge\bfseries\color{corpDark} $title$}

$if(subtitle)$
\vspace{0.5cm}
{\Large\color{corpGray} $subtitle$}
$endif$

\vspace{2cm}

$if(author)$
{\large $for(author)$$author$$sep$ \\ $endfor$}
$endif$

$if(date)$
\vspace{0.5cm}
{\color{corpGray} $date$}
$endif$

\end{flushleft}

\vfill

$if(abstract)$
\begin{corpbox}
\textbf{Abstract}

$abstract$
\end{corpbox}
$endif$

\restoregeometry
\end{titlepage}
$endif$

$for(include-before)$
$include-before$
$endfor$

$if(toc)$
\tableofcontents
\newpage
$endif$

$body$

$for(include-after)$
$include-after$
$endfor$

\end{document}
